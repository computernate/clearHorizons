{% extends "wrapper.html" %}

{% block head %}

<script>
  $(document).ready(function(){

    var formatter = Intl.NumberFormat('en-US',{
      style:'currency',
      currency:'USD'
    })
    var exterior_single_service={{context["exterior_single_service"]}}
    var exterior_biannual_service={{context["exterior_biannual_service"]}}
    var exterior_multi_service={{context["exterior_multi_service"]}}
    var exterior_wfp_single_service={{context["exterior_wfp_single_service"]}}
    var exterior_wfp_biannual_service={{context["exterior_wfp_biannual_service"]}}
    var exterior_wfp_multi_service={{context["exterior_wfp_multi_service"]}}
    var interior_single_service={{context["interior_single_service"]}}
    var interior_biannual_service={{context["interior_biannual_service"]}}
    var interior_multi_service={{context["interior_multi_service"]}}
    var screen_single_service={{context["screen_single_service"]}}
    var screen_biannual_service={{context["screen_biannual_service"]}}
    var screen_multi_service={{context["screen_multi_service"]}}
    var wfp_checked=false;


    function render_results(){
      html=`
          <tr>
            <th>Service type</th>
            <th>Single Service</th>
            <th>Bi-Annual</th>
            <th>Multi-service</th>
          </tr>
      `

      if(wfp_checked){
        html += `
          <tr>
            <td><span class="new-price">Exterior WFP</span></td>
            <td>
              <span class="strike">${formatter.format(exterior_single_service)}</span>
              <span class="new-price">${formatter.format(exterior_wfp_single_service)}</span>
            </td>
            <td>
              <span class="strike">${formatter.format(exterior_biannual_service)}</span>
              <span class="new-price">${formatter.format(exterior_wfp_biannual_service)}</span>
            </td>
            <td>
              <span class="strike">${formatter.format(exterior_multi_service)}</span>
              <span class="new-price">${formatter.format(exterior_wfp_multi_service)}</span>
            </td>
          </tr>
        `
      }
      else{
        html += `
          <tr>
            <td>Exterior</td>
            <td>${formatter.format(exterior_single_service)}</td>
            <td>${formatter.format(exterior_biannual_service)}</td>
            <td>${formatter.format(exterior_multi_service)}</td>
          </tr>
        `
      }
      html+=`
        <tr>
          <td>Interior</td>
          <td>${formatter.format(interior_single_service)}</td>
          <td>${formatter.format(interior_biannual_service)}</td>
          <td>${formatter.format(interior_multi_service)}</td>
        </tr>
      `
      if(screen_single_service>0){
      html+=`
        <tr>
          <td>Interior</td>
          <td>${formatter.format(screen_single_service)}</td>
          <td>${formatter.format(screen_biannual_service)}</td>
          <td>${formatter.format(screen_multi_service)}</td>
        </tr>
      `
      }
      var single_exterior = (wfp_checked)?exterior_wfp_single_service:exterior_single_service
      var single_total = single_exterior+interior_single_service+screen_single_service
      var biannual_exterior = (wfp_checked)?exterior_wfp_biannual_service:exterior_biannual_service
      var biannual_total = biannual_exterior+interior_biannual_service+screen_biannual_service
      var multi_exterior = (wfp_checked)?exterior_wfp_multi_service:exterior_multi_service
      var multi_total = multi_exterior+interior_multi_service+screen_multi_service

      html+=`
        <tr>
          <td>Totals:</td>
          <td>${formatter.format(single_total)}</td>
          <td><span class="strike">${formatter.format(single_total*2)}</span>
              <span class="new-price">${formatter.format(biannual_total*2)}</span></td>
          <td><span class="strike">${formatter.format(single_total*3)}</span>
              <span class="new-price">${formatter.format(multi_total*3)}</span></td>
        </tr>
      `
      $('#results_table').html(html)
    }


    $("#wfp").on("change", function(){
      wfp_checked=!wfp_checked
      render_results()
    })

    render_results()
  })
</script>

{% endblock %}

{% block content %}
<div class="generic-head">
    <div>
        <h1>Your Quote</h1>
    </div>
</div>

<div id="estimate-results">
  <table id="results_table">
    <tr>
      <td>Screens</td>
      <td>{{ "${:,.2f}".format(context["screen_single_service"]) }}</td>
      <td>{{ "${:,.2f}".format(context["screen_biannual_service"]) }}</td>
      <td>{{ "${:,.2f}".format(context["screen_multi_service"]) }}</td>
    </tr>
    <tr>
      <td>Totals</td>
      <td>{{ "${:,.2f}".format(context["screen_single_service"]+context["exterior_single_service"]+context["interior_single_service"]) }}</td>
      <td>{{ "${:,.2f}".format(context["screen_biannual_service"]) }}</td>
      <td>{{ "${:,.2f}".format(context["screen_multi_service"]) }}</td>
    </tr>
  </table>
  <input type="checkbox" id="wfp" /><label> Water Fed Pole (Discounted price, click <a href="#">HERE</a> to learn more)</label>
</div>
{% endblock %}